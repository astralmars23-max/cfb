<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CFP Single-Sim Fidelity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;900&family=JetBrains+Mono:wght@500;700&display=swap');
        :root { --bg: #010203; }
        html, body { height: 100dvh; margin: 0; padding: 0; overflow: hidden; background: var(--bg); color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .grid-container { display: grid; grid-template-rows: auto auto 1fr auto; height: 100dvh; padding: 6px; gap: 6px; box-sizing: border-box; }
        .card { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 10px; display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden; }
        .score-val { font-size: clamp(2rem, 8vh, 3.5rem); font-weight: 900; line-height: 1; letter-spacing: -2px; }
        .btn-core { background: #00f2ff; color: black; font-weight: 900; width: 100%; padding: 16px; border-radius: 6px; text-transform: uppercase; font-size: 0.8rem; cursor: pointer; transition: 0.2s; border: none; box-shadow: 0 4px 15px rgba(0, 242, 255, 0.2); }
        .btn-core:active { transform: translateY(2px); box-shadow: 0 2px 5px rgba(0, 242, 255, 0.4); }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-top: 6px; border-top: 1px solid rgba(255, 255, 255, 0.08); padding-top: 6px; }
        .stat-item { font-size: 0.55rem; color: rgba(255, 255, 255, 0.4); display: flex; flex-direction: column; }
        .stat-item b { color: white; font-family: 'JetBrains Mono'; font-size: 0.75rem; }
        .env-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); padding: 4px 8px; border-radius: 4px; }
        .env-val { color: #00f2ff; font-weight: bold; font-family: 'JetBrains Mono'; font-size: 0.7rem; }
        .log-entry { border-bottom: 1px solid rgba(255,255,255,0.05); padding: 4px 0; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="grid-container">
        <!-- HEADER -->
        <header class="flex justify-between items-center px-3 py-1 bg-white/5 rounded border border-white/5">
            <div class="flex items-center gap-3">
                <span id="status-light" class="w-2 h-2 rounded-full bg-cyan-500 animate-pulse"></span>
                <span class="text-[10px] font-black text-white italic tracking-tighter uppercase">Fidelity Release 1.1</span>
            </div>
            <div class="mono text-[8px] flex gap-4 uppercase">
                <span>Timeline ID: <b id="tg">0</b></span>
                <span>Mode: <b class="text-cyan-400">SINGLE-SIM</b></span>
            </div>
        </header>

        <!-- DYNAMIC ENVIRONMENT STRIP -->
        <div class="grid grid-cols-3 gap-2">
            <div class="env-card">
                <div class="text-[6px] opacity-50 uppercase">Crowd/Noise</div>
                <div id="env-db" class="env-val">---</div>
            </div>
            <div class="env-card">
                <div class="text-[6px] opacity-50 uppercase">Active Aroma</div>
                <div id="env-aroma" class="env-val">---</div>
            </div>
            <div class="env-card">
                <div class="text-[6px] opacity-50 uppercase">Surface Friction</div>
                <div id="env-surface" class="env-val">---</div>
            </div>
        </div>

        <!-- MAIN SIMULATION SPACE -->
        <div class="flex flex-col gap-2 min-h-0">
            <div class="grid grid-cols-2 gap-2 flex-grow">
                <!-- INDIANA -->
                <div class="card border-l-4 border-red-600">
                    <div class="flex justify-between items-start">
                        <span class="font-black text-xs text-red-600 italic">INDIANA</span>
                        <span class="mono text-[8px] opacity-30">91.42</span>
                    </div>
                    <div id="si" class="score-val text-white">00</div>
                    <div class="stat-grid">
                        <div class="stat-item">PASS <b><span id="io_p">0.0</span></b></div>
                        <div class="stat-item">RUSH <b><span id="io_r">0.0</span></b></div>
                        <div class="stat-item">SACKS <b><span id="id_s">0.0</span></b></div>
                        <div class="stat-item">INTS <b><span id="id_i">0.0</span></b></div>
                        <div class="col-span-2 mt-2">
                            <div class="flex justify-between text-[7px] uppercase font-bold mb-1">
                                <span>Running Win Rate</span>
                                <span id="iw" class="text-red-500">0%</span>
                            </div>
                            <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                <div id="ib" class="h-full bg-red-600 w-0 transition-all duration-500"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MIAMI -->
                <div class="card border-r-4 border-orange-500 text-right items-end">
                    <div class="flex flex-row-reverse justify-between w-full items-start">
                        <span class="font-black text-xs text-orange-500 italic">MIAMI</span>
                        <span class="mono text-[8px] opacity-30">89.76</span>
                    </div>
                    <div id="su" class="score-val text-white">00</div>
                    <div class="stat-grid w-full">
                        <div class="stat-item text-left">PASS <b><span id="uo_p">0.0</span></b></div>
                        <div class="stat-item text-left">RUSH <b><span id="uo_r">0.0</span></b></div>
                        <div class="stat-item">SACKS <b><span id="ud_s">0.0</span></b></div>
                        <div class="stat-item">INTS <b><span id="ud_i">0.0</span></b></div>
                        <div class="col-span-2 mt-2">
                            <div class="flex flex-row-reverse justify-between text-[7px] uppercase font-bold mb-1">
                                <span>Running Win Rate</span>
                                <span id="uw" class="text-orange-500">0%</span>
                            </div>
                            <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                <div id="ub" class="h-full bg-orange-500 w-0 ml-auto transition-all duration-500"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTROLS & LIVE LOG -->
            <div class="flex flex-col gap-2">
                <button id="bt" class="btn-core font-black tracking-widest">SIMULATE SINGLE MATCHUP</button>
                <div id="lo" class="bg-black/80 rounded p-2 h-20 overflow-y-auto border border-white/10 mono text-[9px] text-white/60 leading-tight">
                    <div id="log-content">Awaiting initial timeline engagement...</div>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <footer class="grid grid-cols-4 gap-2">
            <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                <span class="text-[6px] uppercase opacity-40 block mb-1">Session Avg</span>
                <span id="fm" class="text-[10px] font-bold text-cyan-400">0.0</span>
            </div>
            <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                <span class="text-[6px] uppercase opacity-40 block mb-1">Last PSI</span>
                <span id="fs" class="text-[10px] font-bold">0.0</span>
            </div>
            <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                <span class="text-[6px] uppercase opacity-40 block mb-1">Humidity</span>
                <span id="ft" class="text-[10px] font-bold text-yellow-500">0%</span>
            </div>
            <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                <span class="text-[6px] uppercase opacity-40 block mb-1">Certainty</span>
                <span id="fc" class="text-[10px] font-bold text-green-500">0%</span>
            </div>
        </footer>
    </div>

    <script>
        const btn = document.getElementById('bt');
        const logContent = document.getElementById('log-content');
        
        let totalSims = 0, winsI = 0;
        let sumScoreI = 0, sumScoreU = 0;
        let sPassI = 0, sRushI = 0, sSackI = 0, sIntI = 0;
        let sPassU = 0, sRushU = 0, sSackU = 0, sIntU = 0;

        const aromas = ["Salt Air", "Fresh Turf", "Sunscreen", "Tailgate", "Miami Humidity"];
        const conditions = ["Cloudy", "Clear", "Breezy", "Stagnant"];

        btn.onclick = () => {
            totalSims++;
            
            // Randomize Environment for this specific sim
            const db = (102 + Math.random() * 16).toFixed(1);
            const aroma = aromas[Math.floor(Math.random() * aromas.length)];
            const surf = (0.92 + Math.random() * 0.08).toFixed(2);
            const hum = (78 + Math.random() * 12).toFixed(1);
            const psi = (12.9 + Math.random() * 0.4).toFixed(2);
            const sky = conditions[Math.floor(Math.random() * conditions.length)];

            // Logic Multipliers
            const crowdImp = (parseFloat(db) - 100) * 0.05;
            const gripImp = (1.0 - parseFloat(surf)) * 10;

            // Generate Score
            const scoreI = Math.round(34 + (Math.random() * 14 - 7) - crowdImp);
            const scoreU = Math.round(27 + (Math.random() * 14 - 7) - crowdImp);

            // Update Totals
            sumScoreI += scoreI;
            sumScoreU += scoreU;
            if (scoreI > scoreU) winsI++;

            // Stats for this game
            const pI = (255 + Math.random() * 40).toFixed(1);
            const rI = (145 + Math.random() * 30 - gripImp).toFixed(1);
            const sI = (2 + Math.random() * 2 + crowdImp/2).toFixed(0);
            const iI = (Math.random() > 0.8 ? 1 : 0);

            const pU = (268 + Math.random() * 40).toFixed(1);
            const rU = (118 + Math.random() * 30 - gripImp).toFixed(1);
            const sU = (1 + Math.random() * 2 + crowdImp/2).toFixed(0);
            const iU = (Math.random() > 0.7 ? 1 : 0);

            // Accumulate Session Averages for the UI display
            sPassI += parseFloat(pI); sRushI += parseFloat(rI); sSackI += parseInt(sI); sIntI += iI;
            sPassU += parseFloat(pU); sRushU += parseFloat(rU); sSackU += parseInt(sU); sIntU += iU;

            // Update UI Top Environment
            document.getElementById('env-db').innerText = db + " dB";
            document.getElementById('env-aroma').innerText = aroma;
            document.getElementById('env-surface').innerText = surf + "Î¼";

            // Update UI Main Cards
            document.getElementById('tg').innerText = totalSims;
            document.getElementById('si').innerText = scoreI;
            document.getElementById('su').innerText = scoreU;

            const winPctI = ((winsI / totalSims) * 100).toFixed(1);
            document.getElementById('iw').innerText = winPctI + "%";
            document.getElementById('uw').innerText = (100 - winPctI).toFixed(1) + "%";
            document.getElementById('ib').style.width = winPctI + "%";
            document.getElementById('ub').style.width = (100 - winPctI) + "%";

            // Update Stat Averages
            document.getElementById('io_p').innerText = (sPassI / totalSims).toFixed(1);
            document.getElementById('io_r').innerText = (sRushI / totalSims).toFixed(1);
            document.getElementById('id_s').innerText = (sSackI / totalSims).toFixed(1);
            document.getElementById('id_i').innerText = (sIntI / totalSims).toFixed(1);

            document.getElementById('uo_p').innerText = (sPassU / totalSims).toFixed(1);
            document.getElementById('uo_r').innerText = (sRushU / totalSims).toFixed(1);
            document.getElementById('ud_s').innerText = (sSackU / totalSims).toFixed(1);
            document.getElementById('ud_i').innerText = (sIntU / totalSims).toFixed(1);

            // Footer
            document.getElementById('fm').innerText = (sumScoreI / totalSims).toFixed(1);
            document.getElementById('fs').innerText = psi;
            document.getElementById('ft').innerText = hum + "%";
            document.getElementById('fc').innerText = Math.min(99, 60 + totalSims).toFixed(0) + "%";

            // Log
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            const winner = scoreI > scoreU ? "IU WIN" : "UM WIN";
            entry.innerHTML = `<span class="text-cyan-400">[SIM #${totalSims}]</span> ${winner}: ${scoreI}-${scoreU} | Env: ${sky}, ${aroma}`;
            logContent.prepend(entry);
        };
    </script>
</body>
</html>

